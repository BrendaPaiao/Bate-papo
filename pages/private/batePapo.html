<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bate-Papo</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    <h1>Bate-Papo</h1>
    <div id="mensagens">
    </div>
    <form action="/enviarMensagem" method="POST">
      <textarea name="mensagem" required></textarea>
      <button type="submit">Enviar</button>
    </form>
    <p><a href="/">Voltar ao menu</a></p>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
          function carregarMensagens() {
              fetch('/mensagens')
                  .then(response => response.json())
                  .then(data => {
                      const mensagensContainer = document.getElementById('mensagens');
                      mensagensContainer.innerHTML = '';
                      data.forEach(mensagem => {
                          const mensagemElement = document.createElement('p');
                          mensagemElement.innerHTML = `<strong>${mensagem.usuario}:</strong> ${mensagem.mensagem} <small>${mensagem.data}</small>`;
                          mensagensContainer.appendChild(mensagemElement);
                      });
                  });
          }

          carregarMensagens();

          setInterval(carregarMensagens, 3000);
      });
  </script>
</body>
</html>